<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zynapse - Chat</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="zynaps.png" type="image/png">
</head>
<body>
    <div class="chat-page" id="chatPage">
        <!-- Loading Screen -->
        <div class="loading-screen" id="loadingScreen">
            <div class="loading-content">
                <img src="zynaps.png" alt="Zynapse Logo" class="loading-logo">
                <div class="spinner-large"></div>
                <p>Loading chat...</p>
            </div>
        </div>

        <!-- Chat Header -->
        <header class="chat-header">
            <button class="back-btn" id="backBtn">
                <i class="fas fa-arrow-left"></i>
            </button>
            
            <div class="chat-user-info">
                <img src="" alt="User" class="chat-user-avatar" id="chatUserAvatar">
                <div class="chat-user-details">
                    <h3 id="chatUserName">Loading...</h3>
                    <div class="chat-status">
                        <span class="status-dot" id="userStatusDot"></span>
                        <span id="userStatusText">Loading...</span>
                    </div>
                </div>
            </div>

            <div class="chat-actions">
                <button class="icon-btn" id="videoCallBtn">
                    <i class="fas fa-video"></i>
                </button>
                <button class="icon-btn" id="voiceCallBtn">
                    <i class="fas fa-phone"></i>
                </button>
                <button class="icon-btn" id="chatMenuBtn">
                    <i class="fas fa-ellipsis-v"></i>
                </button>
            </div>
        </header>

        <!-- Chat Messages -->
        <div class="chat-messages" id="chatMessages">
            <!-- Messages will be dynamically loaded here -->
            <div class="empty-state">
                <i class="far fa-comments"></i>
                <h3>No messages yet</h3>
                <p>Send a message to start the conversation</p>
            </div>
        </div>

        <!-- Typing Indicator -->
        <div class="typing-indicator hidden" id="typingIndicator">
            <div class="typing-bubble">
                <div class="typing-dots">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
                <span class="typing-text" id="typingText">typing...</span>
            </div>
        </div>

        <!-- Message Input -->
        <div class="message-input-area">
            <div class="message-input-container">
                <button class="attach-btn" id="attachBtn">
                    <i class="fas fa-plus"></i>
                </button>
                <textarea class="message-input" id="messageInput" placeholder="iMessage" rows="1"></textarea>
                <button class="send-btn" id="sendBtn">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>

        <!-- Attachment Options -->
        <div class="attachment-options" id="attachmentOptions">
            <button class="attachment-btn" data-type="photo">
                <i class="fas fa-image"></i>
                <span>Photo</span>
            </button>
            <button class="attachment-btn" data-type="video">
                <i class="fas fa-video"></i>
                <span>Video</span>
            </button>
            <button class="attachment-btn" data-type="document">
                <i class="fas fa-file"></i>
                <span>Document</span>
            </button>
            <button class="attachment-btn" data-type="location">
                <i class="fas fa-map-marker-alt"></i>
                <span>Location</span>
            </button>
            <button class="attachment-btn" data-type="viewOnce">
                <i class="fas fa-eye"></i>
                <span>View Once</span>
            </button>
            <button class="attachment-btn" data-type="voice">
                <i class="fas fa-microphone"></i>
                <span>Voice Note</span>
            </button>
        </div>
    </div>

    <!-- Chat Menu Dropdown -->
    <div class="dropdown">
        <div class="dropdown-content" id="chatMenuDropdown">
            <button class="dropdown-item" id="addNicknameBtn">
                <i class="fas fa-tag"></i> Add Nickname
            </button>
            <button class="dropdown-item" id="viewProfileChatBtn">
                <i class="fas fa-user"></i> View Profile
            </button>
            <button class="dropdown-item" id="blockUserBtn">
                <i class="fas fa-ban"></i> Block User
            </button>
            <button class="dropdown-item" id="addToFavoritesBtn">
                <i class="fas fa-star"></i> Add to Favorites
            </button>
            <button class="dropdown-item danger" id="deleteChatBtn">
                <i class="fas fa-trash"></i> Delete Chat
            </button>
        </div>
    </div>

    <!-- File Inputs (hidden) -->
    <input type="file" id="photoInput" accept="image/*" hidden>
    <input type="file" id="videoInput" accept="video/*" hidden>
    <input type="file" id="documentInput" accept=".pdf,.doc,.docx,.txt" hidden>
    <input type="file" id="audioInput" accept="audio/*" hidden>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Audio for notifications -->
    <audio id="notificationSound" src="notification.mp3" preload="auto"></audio>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
    <script src="https://unpkg.com/cloudinary-core@2.11.4/cloudinary-core-shrinkwrap.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
